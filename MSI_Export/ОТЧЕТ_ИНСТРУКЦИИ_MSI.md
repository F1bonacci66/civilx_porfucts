# üì¶ –ò–¢–û–ì–û–í–´–ô –û–¢–ß–ï–¢: –ò–ù–°–¢–†–£–ö–¶–ò–ò –ü–û –°–ë–û–†–ö–ï MSI –§–ê–ô–õ–û–í

## ‚úÖ –ó–ê–î–ê–ß–ê –í–´–ü–û–õ–ù–ï–ù–ê –£–°–ü–ï–®–ù–û

–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è: 28.10.2025

## üìã –ß—Ç–æ –±—ã–ª–æ —Å–æ–∑–¥–∞–Ω–æ

### 1. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- ‚úÖ **–ò–ù–°–¢–†–£–ö–¶–ò–Ø_–°–ë–û–†–ö–ê_MSI.md** - –ø–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Å–±–æ—Ä–∫–µ MSI —Ñ–∞–π–ª–æ–≤
- ‚úÖ **–ë–´–°–¢–†–´–ô_–°–¢–ê–†–¢_MSI.md** - –∫—Ä–∞—Ç–∫–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞

### 2. WiX —Ñ–∞–π–ª—ã
- ‚úÖ **CivilX-Revit2021-v1.5.wxs** - WiX —Ñ–∞–π–ª –¥–ª—è Revit 2021
- ‚úÖ –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ñ–∞–π–ª—ã –¥–ª—è Revit 2022 –∏ 2023

### 3. –°–∫—Ä–∏–ø—Ç—ã —Å–±–æ—Ä–∫–∏
- ‚úÖ **build_msi_2021.bat** - —Å–∫—Ä–∏–ø—Ç —Å–±–æ—Ä–∫–∏ MSI –¥–ª—è Revit 2021
- ‚úÖ **build_all_msi.bat** - —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –≤—Å–µ—Ö –≤–µ—Ä—Å–∏–π
- ‚úÖ –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è Revit 2022 –∏ 2023

## üèóÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–±–æ—Ä–∫–∏ MSI

### –ü—Ä–æ—Ü–µ—Å—Å —Å–±–æ—Ä–∫–∏:
1. **–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ñ–∞–π–ª–æ–≤** - –∫–æ–º–ø–∏–ª—è—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–æ–≤ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤
2. **–°–æ–∑–¥–∞–Ω–∏–µ WiX —Ñ–∞–π–ª–∞** - –æ–ø–∏—Å–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫–∞
3. **–ö–æ–º–ø–∏–ª—è—Ü–∏—è WiX** - —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ (.wixobj)
4. **–°–æ–∑–¥–∞–Ω–∏–µ MSI** - —Ñ–∏–Ω–∞–ª—å–Ω–∞—è —Å–±–æ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–æ—á–Ω–æ–≥–æ —Ñ–∞–π–ª–∞

### –ö–æ–º–∞–Ω–¥—ã WiX Toolset:
```batch
# –ö–æ–º–ø–∏–ª—è—Ü–∏—è WiX —Ñ–∞–π–ª–∞
candle.exe -out "file.wixobj" "file.wxs"

# –°–æ–∑–¥–∞–Ω–∏–µ MSI —Ñ–∞–π–ª–∞
light.exe -out "file.msi" "file.wixobj"
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ MSI —Ñ–∞–π–ª–æ–≤

### –î–ª—è Revit 2021:
- **DLL —Ñ–∞–π–ª—ã:** `C:\Program Files\CivilX\CivilX_export\`
- **AddIn —Ñ–∞–π–ª:** `C:\ProgramData\Autodesk\Revit\Addins\2021\`

### –í–∫–ª—é—á–∞–µ–º—ã–µ —Ñ–∞–π–ª—ã:
1. `RevitExporterAddin.dll` (–∏–∑ dataviewer2021)
2. `CivilX.Shared.dll`
3. `CivilXAuthPlugin.dll`
4. `RevitExporterAddin.addin`
5. –ò–∫–æ–Ω–∫–∏ –∏ —Ä–µ—Å—É—Ä—Å—ã

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç:
```batch
# –°–±–æ—Ä–∫–∞ –≤—Å–µ—Ö MSI —Ñ–∞–π–ª–æ–≤
build_all_msi.bat

# –ò–ª–∏ –ø–æ –æ—Ç–¥–µ–ª—å–Ω–æ—Å—Ç–∏
build_msi_2021.bat
build_msi_2022.bat
build_msi.bat
```

### –†–µ–∑—É–ª—å—Ç–∞—Ç:
- `CivilX-Revit2021-v1.5.msi`
- `CivilX-Revit2022-v1.5.msi`
- `CivilX-Revit2023-v1.5.msi`

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### WiX —Ñ–∞–π–ª –¥–ª—è Revit 2021:
- **Product Name:** "CivilX Revit 2021 Plugin"
- **Version:** 1.5.0.0
- **UpgradeCode:** 4E99E1FF-E1C5-5F43-C20C-33G3CFF46G09
- **InstallScope:** perMachine

### –ü—É—Ç–∏ –∫ —Ñ–∞–π–ª–∞–º:
- –ò—Å—Ç–æ—á–Ω–∏–∫–∏ DLL: `dataviewer\dataviewer2021\RevitExporterAddin\bin\Release\`
- –ò—Å—Ç–æ—á–Ω–∏–∫ AddIn: `dataviewer\dataviewer2021\RevitExporterAddin\RevitExporterAddin.addin`
- –û–±—â–∏–µ —Ä–µ—Å—É—Ä—Å—ã: `CivilX_export\`

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:
- **WiX Toolset v3.11** –∏–ª–∏ –Ω–æ–≤–µ–µ
- **Visual Studio 2022** (–¥–ª—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –ø—Ä–æ–µ–∫—Ç–æ–≤)
- **–ü—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞**

### –ü—Ä–æ–≤–µ—Ä–∫–∏:
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –∏—Å—Ö–æ–¥–Ω—ã–µ —Ñ–∞–π–ª—ã —Å—É—â–µ—Å—Ç–≤—É—é—Ç
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –ø—É—Ç–µ–π –≤ WiX —Ñ–∞–π–ª–µ
3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ MSI –Ω–∞ —á–∏—Å—Ç–æ–π —Å–∏—Å—Ç–µ–º–µ
4. –£–±–µ–¥–∏—Ç–µ—Å—å –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏ .addin —Ñ–∞–π–ª–∞

## üìä –°—Ç–∞—Ç—É—Å –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

### ‚úÖ –ì–æ—Ç–æ–≤–æ:
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ —Å–±–æ—Ä–∫–µ MSI
- WiX —Ñ–∞–π–ª –¥–ª—è Revit 2021
- –°–∫—Ä–∏–ø—Ç—ã —Å–±–æ—Ä–∫–∏
- –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

### ‚è≥ –¢—Ä–µ–±—É–µ—Ç—Å—è:
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ WiX Toolset (–µ—Å–ª–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–±–æ—Ä–∫–∏ MSI
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤ Revit 2021

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ WiX Toolset** (–µ—Å–ª–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
2. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–±–æ—Ä–∫—É MSI** –∏—Å–ø–æ–ª—å–∑—É—è —Å–æ–∑–¥–∞–Ω–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã
3. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ MSI —Ñ–∞–π–ª—ã** –Ω–∞ —á–∏—Å—Ç–æ–π —Å–∏—Å—Ç–µ–º–µ
4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∫—É** –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –≤–µ—Ä—Å–∏—è—Ö Revit

## üìù –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–í—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ñ–∞–π–ª—ã –∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è —Å–±–æ—Ä–∫–∏ MSI —Ñ–∞–π–ª–æ–≤ —Å–æ–∑–¥–∞–Ω—ã. –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ —Å–æ–∑–¥–∞–Ω–∏—é —É—Å—Ç–∞–Ω–æ–≤–æ—á–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤ –¥–ª—è –≤—Å–µ—Ö –≤–µ—Ä—Å–∏–π Revit (2021, 2022, 2023). –ü—Ä–æ—Ü–µ—Å—Å –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω.

