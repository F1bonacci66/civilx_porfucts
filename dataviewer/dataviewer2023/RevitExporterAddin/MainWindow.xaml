<Window x:Class="RevitExporterAddin.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Revit Exporter" Height="600" Width="800"
        WindowStartupLocation="CenterScreen">
    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Заголовок -->
        <TextBlock Grid.Row="0" Text="Revit Exporter" FontSize="24" FontWeight="Bold" 
                   HorizontalAlignment="Center" Margin="0,0,0,20"/>

        <!-- Выбор файла -->
        <GroupBox Grid.Row="1" Header="Выбор Revit файла" Margin="0,0,0,10">
            <Grid Margin="10">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <TextBox x:Name="FilePathTextBox" Grid.Column="0" Margin="0,0,10,0" 
                         IsReadOnly="True" Text="Текущий документ Revit"/>
                <Button x:Name="SelectFileButton" Grid.Column="1" Content="Выбрать .rvt файл" 
                        Width="120" Click="SelectFileButton_Click"/>
            </Grid>
        </GroupBox>

        <!-- Настройки экспорта -->
        <GroupBox Grid.Row="2" Header="Настройки экспорта" Margin="0,0,0,10">
            <Grid Margin="10">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <TextBlock Grid.Row="0" Grid.Column="0" Text="Папка для сохранения:" 
                           VerticalAlignment="Center" Margin="0,0,10,0"/>
                <Button x:Name="SelectOutputFolderButton" Grid.Row="0" Grid.Column="1" 
                        Content="Выбрать папку" HorizontalAlignment="Left" Width="120" 
                        Click="SelectOutputFolderButton_Click"/>

                <TextBlock Grid.Row="1" Grid.Column="0" Text="Имя файла:" 
                           VerticalAlignment="Center" Margin="0,0,10,0"/>
                <TextBox x:Name="FileNameTextBox" Grid.Row="1" Grid.Column="1" 
                         Text="export" Margin="0,5,0,0"/>
            </Grid>
        </GroupBox>

        <!-- Лог -->
        <GroupBox Grid.Row="3" Header="Лог выполнения" Margin="0,0,0,10">
            <ScrollViewer VerticalScrollBarVisibility="Auto">
                <TextBox x:Name="LogTextBox" IsReadOnly="True" FontFamily="Consolas" 
                         FontSize="10" Background="#F5F5F5"/>
            </ScrollViewer>
        </GroupBox>

        <!-- Кнопки -->
        <StackPanel Grid.Row="4" Orientation="Horizontal" HorizontalAlignment="Center">
            <Button x:Name="ExportButton" Content="Экспорт в CSV" Width="150" Height="40" 
                    FontSize="14" Click="ExportButton_Click" Margin="0,0,10,0"/>
            <Button x:Name="ClearLogButton" Content="Очистить лог" Width="120" Height="40" 
                    Click="ClearLogButton_Click"/>
        </StackPanel>
    </Grid>
</Window>
