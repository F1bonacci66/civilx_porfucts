# Revit Exporter

Приложение для выгрузки данных из моделей Autodesk Revit в CSV-формат.

## Описание

Revit Exporter - это Windows-приложение, разработанное на C# WPF с использованием паттерна MVVM. Приложение позволяет создавать проекты, настраивать выгрузки и экспортировать данные из моделей Revit в CSV-файлы.

## Функциональность

- **Управление проектами**: Создание, удаление и организация проектов
- **Настройка выгрузок**: Создание выгрузок с множественными вкладками
- **Конфигурация экспорта**: Настройка версии Revit и папки с моделями
- **Экспорт в CSV**: Выгрузка данных в формате CSV с заголовками ModelName, ElementId, ParameterName, ParameterValue

## Структура проекта

```
RevitExporter/
├── Models/                 # Модели данных
│   ├── Project.cs         # Модель проекта
│   ├── Export.cs          # Модель выгрузки
│   └── ExportTab.cs       # Модель вкладки выгрузки
├── Services/              # Сервисы
│   ├── IDataService.cs    # Интерфейс сервиса данных
│   ├── DataService.cs     # Реализация сервиса данных
│   ├── IRevitExporter.cs  # Интерфейс экспортера
│   └── RevitExporter.cs   # Реализация экспортера
├── ViewModels/            # ViewModels для MVVM
│   ├── BaseViewModel.cs   # Базовый ViewModel
│   └── MainViewModel.cs   # Главный ViewModel
├── Views/                 # Представления
│   └── MainWindow.xaml    # Главное окно приложения
├── Converters/            # Конвертеры для XAML
│   └── BooleanInverterConverter.cs
├── App.xaml              # Точка входа приложения
└── RevitExporter.csproj  # Файл проекта
```

## Требования

- .NET Framework 4.8
- Windows 10/11
- Autodesk Revit (для полной функциональности)

## Установка и запуск

### Вариант 1: Запуск из Visual Studio
1. Откройте решение в Visual Studio 2022
2. Восстановите NuGet пакеты (если используете полную версию)
3. Соберите проект (Build → Build Solution)
4. Запустите приложение (F5 или Ctrl+F5)

### Вариант 2: Запуск готового exe файла
1. Перейдите в папку `bin\Debug\`
2. Запустите `RevitExporter.exe`

## Использование

1. **Создание проекта**: Нажмите "+" в разделе "Проекты"
2. **Создание выгрузки**: Выберите проект и нажмите "+" в разделе "Выгрузки"
3. **Добавление вкладки**: Выберите выгрузку и нажмите "+" в разделе "Вкладки"
4. **Настройка экспорта**:
   - Укажите название вкладки
   - Выберите версию Revit
   - Укажите папку с моделями Revit (.rvt файлы)
5. **Запуск экспорта**: Нажмите "Запустить выгрузку"

## Формат CSV

Экспортированные данные сохраняются в формате:
```csv
ModelName,ElementId,ParameterName,ParameterValue
Model1,1234,Name,Wall-1
Model1,1234,Type,Basic Wall
Model1,1234,Level,Level 1
```

## Архитектура

Приложение использует:
- **MVVM паттерн** для разделения логики и представления
- **WPF** для пользовательского интерфейса
- **JSON** для хранения данных проектов (в полной версии)

## Текущая версия

### Упрощенная версия (текущая)
- Работает без внешних зависимостей
- Использует .NET Framework 4.8
- Базовая функциональность без интеграции с Revit API
- Генерирует тестовые CSV файлы

### Полная версия (планируется)
Для полной функциональности необходимо:
1. Раскомментировать NuGet пакеты в `RevitExporter.csproj`
2. Установить Autodesk Revit
3. Раскомментировать ссылки на Revit API
4. Реализовать полную интеграцию с Revit API

## Разработка

### Добавление новой функциональности

1. Создайте модель в папке `Models/`
2. Добавьте сервис в папку `Services/`
3. Создайте ViewModel в папке `ViewModels/`
4. Обновите представление в папке `Views/`

### Интеграция с Revit API

Для полной интеграции с Revit API необходимо:
1. Установить Autodesk Revit
2. Раскомментировать ссылки на RevitAPI.dll и RevitAPIUI.dll в проекте
3. Реализовать логику работы с Revit в `RevitExporter.cs`

## Особенности интерфейса

Интерфейс разработан в соответствии с вашими требованиями:
- Простой и минималистичный дизайн
- Три колонки: Проекты, Выгрузки, Вкладки
- Настройки вкладки внизу окна
- Статус экспорта в нижней части

## Лицензия

Этот проект разработан для внутреннего использования.

## Поддержка

По вопросам использования и разработки обращайтесь к команде разработки.

---

**Примечание**: Текущая версия является демонстрационной и генерирует тестовые данные. Для работы с реальными моделями Revit требуется интеграция с Revit API.
