<Window x:Class="RevitExporter.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:RevitExporter.Converters"
        Title="Revit Exporter" Height="600" Width="1000"
        WindowStartupLocation="CenterScreen">
    
    <Window.Resources>
        <Style x:Key="ModernButton" TargetType="Button">
            <Setter Property="Background" Value="#F0F0F0"/>
            <Setter Property="BorderBrush" Value="#CCCCCC"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="10,5"/>
            <Setter Property="Margin" Value="5"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="4">
                            <ContentPresenter HorizontalAlignment="Center" 
                                            VerticalAlignment="Center"
                                            Margin="{TemplateBinding Padding}"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#E0E0E0"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="#D0D0D0"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="ModernListBox" TargetType="ListBox">
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderBrush" Value="#CCCCCC"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="5"/>
        </Style>

        <Style x:Key="ModernTextBox" TargetType="TextBox">
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderBrush" Value="#CCCCCC"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="5"/>
            <Setter Property="FontSize" Value="12"/>
        </Style>
    </Window.Resources>

    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <Grid Grid.Row="0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="250"/>
                <ColumnDefinition Width="5"/>
                <ColumnDefinition Width="250"/>
                <ColumnDefinition Width="5"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Проекты -->
            <Border Grid.Column="0" Background="White" BorderBrush="#CCCCCC" BorderThickness="1" CornerRadius="4">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <TextBlock Grid.Row="0" Text="Проекты" FontWeight="Bold" Margin="10,10,10,5" FontSize="14"/>
                    
                    <ListBox Grid.Row="1" ItemsSource="{Binding Projects}" 
                             SelectedItem="{Binding SelectedProject}"
                             Style="{StaticResource ModernListBox}"
                             Margin="10,0,10,10">
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding Name}" Padding="5"/>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>

                    <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="10,0,10,10">
                        <Button Content="+" Command="{Binding AddProjectCommand}" 
                                Style="{StaticResource ModernButton}" Width="40"/>
                        <Button Content="-" Command="{Binding RemoveProjectCommand}" 
                                Style="{StaticResource ModernButton}" Width="40"/>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- Выгрузки -->
            <Border Grid.Column="2" Background="White" BorderBrush="#CCCCCC" BorderThickness="1" CornerRadius="4">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <TextBlock Grid.Row="0" Text="Выгрузки" FontWeight="Bold" Margin="10,10,10,5" FontSize="14"/>
                    
                    <ListBox Grid.Row="1" ItemsSource="{Binding Exports}" 
                             SelectedItem="{Binding SelectedExport}"
                             Style="{StaticResource ModernListBox}"
                             Margin="10,0,10,10">
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding Name}" Padding="5"/>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>

                    <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="10,0,10,10">
                        <Button Content="+" Command="{Binding AddExportCommand}" 
                                Style="{StaticResource ModernButton}" Width="40"/>
                        <Button Content="-" Command="{Binding RemoveExportCommand}" 
                                Style="{StaticResource ModernButton}" Width="40"/>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- Вкладки и настройки -->
            <Border Grid.Column="4" Background="White" BorderBrush="#CCCCCC" BorderThickness="1" CornerRadius="4">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <TextBlock Grid.Row="0" Text="Вкладки" FontWeight="Bold" Margin="10,10,10,5" FontSize="14"/>
                    
                    <ListBox Grid.Row="1" ItemsSource="{Binding Tabs}" 
                             SelectedItem="{Binding SelectedTab}"
                             Style="{StaticResource ModernListBox}"
                             Margin="10,0,10,10">
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding Name}" Padding="5"/>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>

                    <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="10,0,10,10">
                        <Button Content="+" Command="{Binding AddTabCommand}" 
                                Style="{StaticResource ModernButton}" Width="40"/>
                        <Button Content="-" Command="{Binding RemoveTabCommand}" 
                                Style="{StaticResource ModernButton}" Width="40"/>
                    </StackPanel>
                </Grid>
            </Border>
        </Grid>

        <!-- Настройки вкладки -->
        <Border Grid.Row="1" Background="#F8F8F8" BorderBrush="#CCCCCC" BorderThickness="1" CornerRadius="4" Margin="0,10,0,0" 
                Visibility="{Binding SelectedTab, Converter={x:Static local:NullToVisibilityConverter.Instance}}">
            <Grid Margin="10">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="120"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <TextBlock Grid.Row="0" Grid.Column="0" Text="Название вкладки:" VerticalAlignment="Center" Margin="0,5"/>
                <TextBox Grid.Row="0" Grid.Column="1" Text="{Binding SelectedTab.Name, UpdateSourceTrigger=PropertyChanged}" 
                         Style="{StaticResource ModernTextBox}" Margin="0,5"/>

                <TextBlock Grid.Row="1" Grid.Column="0" Text="Версия Revit:" VerticalAlignment="Center" Margin="0,5"/>
                <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding SelectedTab.RevitVersion, UpdateSourceTrigger=PropertyChanged}" 
                         Style="{StaticResource ModernTextBox}" Margin="0,5"/>

                <TextBlock Grid.Row="2" Grid.Column="0" Text="Папка с моделями:" VerticalAlignment="Center" Margin="0,5"/>
                <TextBox Grid.Row="2" Grid.Column="1" Text="{Binding SelectedTab.ModelsFolder, UpdateSourceTrigger=PropertyChanged}" 
                         Style="{StaticResource ModernTextBox}" Margin="0,5" IsReadOnly="True"/>
                <Button Grid.Row="2" Grid.Column="2" Content="Обзор" Command="{Binding BrowseFolderCommand}" 
                        Style="{StaticResource ModernButton}" Margin="5,5,0,5"/>

                <StackPanel Grid.Row="3" Grid.Column="1" Grid.ColumnSpan="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,10,0,0">
                    <Button Content="Запустить выгрузку" Command="{Binding StartExportCommand}" 
                            Style="{StaticResource ModernButton}" 
                            Background="#4CAF50" Foreground="White" 
                            IsEnabled="{Binding IsExporting, Converter={x:Static local:BooleanInverterConverter.Instance}}"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Статус -->
        <Border Grid.Row="2" Background="#E8F5E8" BorderBrush="#4CAF50" BorderThickness="1" CornerRadius="4" Margin="0,10,0,0">
            <TextBlock Text="{Binding StatusMessage}" Margin="10,5" FontSize="12"/>
        </Border>
    </Grid>
</Window>
