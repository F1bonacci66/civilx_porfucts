# –û—Ç—á–µ—Ç –æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –≤ DataViewer

## –î–∞—Ç–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
06.10.2025 12:33

## –ó–∞–¥–∞—á–∞
–î–æ–±–∞–≤–∏—Ç—å –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å DataViewer –±–ª–æ–∫ "–§–∏–ª—å—Ç—Ä—ã" —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –≤—ã–±–æ—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –ø–æ 6 –±–ª–æ–∫–∞–º:
1. –≠–ª–µ–º–µ–Ω—Ç—ã –º–æ–¥–µ–ª–∏
2. –ò–Ω–∂–µ–Ω–µ—Ä–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã (MEP)
3. –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –º–æ–¥–µ–ª–∏
4. –ê–Ω–Ω–æ—Ç–∞—Ü–∏–∏ –∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ
5. –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞ –∏ –≤–∏–¥—ã
6. –î–∞–Ω–Ω—ã–µ –∏ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏

## –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### 1. –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö - CategoryFilter.cs
**–ü—É—Ç—å**: `dataviewer/RevitExporterAddin/Models/CategoryFilter.cs`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å**:
- –•—Ä–∞–Ω–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –ø–æ 6 –±–ª–æ–∫–∞–º
- –ü–æ–¥—Å—á–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö/–æ–±—â–∏—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π
- –ú–µ—Ç–æ–¥—ã –¥–ª—è –≤—ã–±–æ—Ä–∞/—Å–Ω—è—Ç–∏—è –≤—ã–±–æ—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –ø–æ –±–ª–æ–∫–∞–º
- –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π

**–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã**:
- `GetSelectedCategories()` - –ø–æ–ª—É—á–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- `GetSelectedCount()` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö
- `GetTotalCount()` - –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
- `SelectAllInBlock()` / `DeselectAllInBlock()` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ –±–ª–æ–∫–∞–º
- `SelectAll()` / `DeselectAll()` - –≥–ª–æ–±–∞–ª—å–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

### 2. –û–∫–Ω–æ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ - CategoryFilterWindow
**XAML**: `dataviewer/RevitExporterAddin/Views/CategoryFilterWindow.xaml`
**Code-behind**: `dataviewer/RevitExporterAddin/Views/CategoryFilterWindow.xaml.cs`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å**:
- 6 –≤–∫–ª–∞–¥–æ–∫ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –±–ª–æ–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
- –°–ø–∏—Å–∫–∏ —Å —á–µ–∫–±–æ–∫—Å–∞–º–∏ –¥–ª—è –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- –ö–Ω–æ–ø–∫–∏ "–í—ã–±—Ä–∞—Ç—å –≤—Å–µ" / "–°–Ω—è—Ç—å –≤—Å–µ" –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –±–ª–æ–∫–∞
- –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ "–í—ã–±—Ä–∞—Ç—å –≤—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏" / "–°–Ω—è—Ç—å –≤—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏"
- –°—á–µ—Ç—á–∏–∫ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ
- –í–∞–ª–∏–¥–∞—Ü–∏—è - –Ω–µ–ª—å–∑—è –∑–∞–∫—Ä—ã—Ç—å –æ–∫–Ω–æ –±–µ–∑ –≤—ã–±–æ—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π

**–†–∞–∑–º–µ—Ä –æ–∫–Ω–∞**: 1000x800 –ø–∏–∫—Å–µ–ª–µ–π (–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω)

### 3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –æ—Å–Ω–æ–≤–Ω–æ–µ –æ–∫–Ω–æ
**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤**: `dataviewer/RevitExporterAddin/Views/TabContentView.xaml`

**–î–æ–±–∞–≤–ª–µ–Ω –±–ª–æ–∫ "–§–∏–ª—å—Ç—Ä—ã"**:
- –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω –ø–æ—Å–ª–µ "–ü–∞–ø–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤"
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π
- –ö–Ω–æ–ø–∫–∞ "–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å" –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –æ–∫–Ω–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤**: `dataviewer/RevitExporterAddin/Views/TabContentView.xaml.cs`

**–ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å**:
- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–∏–ª—å—Ç—Ä–∞ —Å –≤—ã–±—Ä–∞–Ω–Ω—ã–º–∏ –≤—Å–µ–º–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
- –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ "–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å" —Ñ–∏–ª—å—Ç—Ä—ã
- –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–∏ —ç–∫—Å–ø–æ—Ä—Ç–µ - –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–±–æ—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
- –ú–µ—Ç–æ–¥ `GetCategoryFilter()` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞

### 4. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤**: `dataviewer/RevitExporterAddin/RevitExporterAddin.csproj`

**–î–æ–±–∞–≤–ª–µ–Ω—ã —Ñ–∞–π–ª—ã**:
- `Models\CategoryFilter.cs`
- `Views\CategoryFilterWindow.xaml`
- `Views\CategoryFilterWindow.xaml.cs`

## –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

### –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
- –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–∏ —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –≤—ã–±—Ä–∞–Ω—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è "–í—ã–±—Ä–∞–Ω–æ: X –∏–∑ Y –∫–∞—Ç–µ–≥–æ—Ä–∏–π"

### –í—ã–±–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–π
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å" –≤ –±–ª–æ–∫–µ "–§–∏–ª—å—Ç—Ä—ã"
2. –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –æ–∫–Ω–æ —Å 6 –≤–∫–ª–∞–¥–∫–∞–º–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç:
   - –í—ã–±–∏—Ä–∞—Ç—å/—Å–Ω–∏–º–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å "–í—ã–±—Ä–∞—Ç—å –≤—Å–µ" / "–°–Ω—è—Ç—å –≤—Å–µ" –¥–ª—è –±–ª–æ–∫–∞
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ –¥–ª—è –≤—Å–µ—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π
4. –°—á–µ—Ç—á–∏–∫ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
5. –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ "OK" –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è

### –í–∞–ª–∏–¥–∞—Ü–∏—è
- –ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ —ç–∫—Å–ø–æ—Ä—Ç–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è, —á—Ç–æ –≤—ã–±—Ä–∞–Ω–∞ —Ö–æ—Ç—è –±—ã –æ–¥–Ω–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏—è
- –ï—Å–ª–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–µ –≤—ã–±—Ä–∞–Ω—ã, –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
- –û–∫–Ω–æ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –Ω–µ–ª—å–∑—è –∑–∞–∫—Ä—ã—Ç—å –±–µ–∑ –≤—ã–±–æ—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π

### –≠–∫—Å–ø–æ—Ä—Ç
- –ü—Ä–∏ —ç–∫—Å–ø–æ—Ä—Ç–µ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è —Å–ø–∏—Å–æ–∫ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π
- –õ–æ–≥–∏–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –±—É–¥–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–∞ –≤ RevitDataReader

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ü—Ä–∏–≤—è–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `INotifyPropertyChanged` –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è UI
- –ü—Ä–∏–≤—è–∑–∫–∞ —á–µ—Ä–µ–∑ `ItemsSource="{Binding CategoryBlocks[–ù–∞–∑–≤–∞–Ω–∏–µ –±–ª–æ–∫–∞]}"`
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–æ–≤ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –≤—ã–±–æ—Ä–∞

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç—å—é
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `WeakReference` –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è —É—Ç–µ—á–µ–∫ –ø–∞–º—è—Ç–∏
- –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –ø–æ–¥–ø–∏—Å–æ–∫ –Ω–∞ —Å–æ–±—ã—Ç–∏—è

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å UI
- –ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö

## –†–µ–∑—É–ª—å—Ç–∞—Ç

### ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:
1. **6 –±–ª–æ–∫–æ–≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–π** —Å –ø–æ–ª–Ω—ã–º —Å–ø–∏—Å–∫–æ–º –∫–∞—Ç–µ–≥–æ—Ä–∏–π –∏–∑ —Ñ–∞–π–ª–∞ "–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏.txt"
2. **–ò–Ω—Ç—É–∏—Ç–∏–≤–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å** —Å –≤–∫–ª–∞–¥–∫–∞–º–∏ –∏ —á–µ–∫–±–æ–∫—Å–∞–º–∏
3. **–ì–∏–±–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ** –≤—ã–±–æ—Ä–æ–º (–ø–æ –±–ª–æ–∫–∞–º –∏ –≥–ª–æ–±–∞–ª—å–Ω–æ)
4. **–í–∞–ª–∏–¥–∞—Ü–∏—è** - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –≤—ã–±–æ—Ä —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
5. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** –≤ –æ—Å–Ω–æ–≤–Ω–æ–µ –æ–∫–Ω–æ DataViewer
6. **–°—á–µ—Ç—á–∏–∫–∏** –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π
7. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫** –¥–ª—è –∫–∞–∂–¥–æ–π –≤–∫–ª–∞–¥–∫–∏ —ç–∫—Å–ø–æ—Ä—Ç–∞

### üîÑ –ì–æ—Ç–æ–≤–æ –∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:
- –õ–æ–≥–∏–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –≥–æ—Ç–æ–≤–∞ –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤ `RevitDataReader`
- –ú–µ—Ç–æ–¥ `GetCategoryFilter()` –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –¥–æ—Å—Ç—É–ø –∫ –≤—ã–±—Ä–∞–Ω–Ω—ã–º –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
- –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç —ç–∫—Å–ø–æ—Ä—Ç –±–µ–∑ –≤—ã–±–æ—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π

## –ö–æ–º–ø–∏–ª—è—Ü–∏—è
–ü—Ä–æ–µ–∫—Ç —É—Å–ø–µ—à–Ω–æ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω —Å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è–º–∏ (–Ω–µ –∫—Ä–∏—Ç–∏—á–Ω—ã–º–∏).

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏
1. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –≤ `RevitDataReader.GetElementData()`
2. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ Revit
3. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π

---
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ  
**–ì–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é**: –î–∞






