# Инструкции по тестированию Revit Exporter

## Быстрый старт

### 1. Запуск приложения
Приложение уже собрано и готово к использованию. Запустите:
```
C:\RevitExporter\bin\Debug\RevitExporter.exe
```

### 2. Тестовая папка с моделями
Создана тестовая папка: `C:\TestRevitModels\` с файлом `TestModel.rvt`

## Пошаговое тестирование

### Шаг 1: Создание проекта
1. В разделе "Проекты" нажмите кнопку "+"
2. Должен появиться новый проект "Новый проект 1"
3. Выберите созданный проект

### Шаг 2: Создание выгрузки
1. В разделе "Выгрузки" нажмите кнопку "+"
2. Должна появиться новая выгрузка "Выгрузка 1"
3. Выберите созданную выгрузку

### Шаг 3: Создание вкладки
1. В разделе "Вкладки" нажмите кнопку "+"
2. Должна появиться новая вкладка "Вкладка 1"
3. **ВАЖНО**: Выберите созданную вкладку (кликните на неё в списке)

### Шаг 4: Настройка экспорта
**После выбора вкладки внизу окна должны появиться поля настроек:**

Вы должны увидеть серую панель внизу окна с полями:
- "Название вкладки:" (текстовое поле)
- "Версия Revit:" (текстовое поле с "2024")
- "Папка с моделями:" (текстовое поле + кнопка "Обзор")
- Кнопка "Запустить выгрузку" (зеленая)

1. В поле "Название вкладки" введите: "Тестовая выгрузка"
2. В поле "Версия Revit" оставьте: "2024"
3. Нажмите кнопку "Обзор" и выберите папку: `C:\TestRevitModels\`
4. Убедитесь, что путь отобразился в поле "Папка с моделями"

### Шаг 5: Запуск экспорта
1. Нажмите кнопку "Запустить выгрузку"
2. В статусе должно появиться: "Начинаем экспорт..."
3. Затем: "Найдено 1 файлов Revit"
4. Затем: "Обрабатываем файл: TestModel"
5. Затем: "Файл сохранен: C:\TestRevitModels\Результаты\TestModel_export.csv"
6. И наконец: "Экспорт успешно завершен!"

### Шаг 6: Проверка результатов
1. Откройте папку: `C:\TestRevitModels\Результаты\`
2. Должен появиться файл: `TestModel_export.csv`
3. Откройте файл в Excel или текстовом редакторе
4. Проверьте формат данных:
   ```
   ModelName,ElementId,ParameterName,ParameterValue
   TestModel,1234,Name,TestValue_1
   TestModel,5678,Type,TestValue_2
   ...
   ```

## Дополнительные тесты

### Тест удаления элементов
1. Выберите любой элемент (проект, выгрузку или вкладку)
2. Нажмите кнопку "-" для удаления
3. Элемент должен исчезнуть из списка

### Тест множественных элементов
1. Создайте несколько проектов
2. В каждом проекте создайте несколько выгрузок
3. В каждой выгрузке создайте несколько вкладок
4. Проверьте, что все элементы отображаются корректно

### Тест изменения названий
1. Выберите вкладку
2. Измените название в поле "Название вкладки"
3. Название должно обновиться в списке вкладок

## Ожидаемые результаты

### Успешное тестирование
- ✅ Приложение запускается без ошибок
- ✅ Все кнопки работают корректно
- ✅ Данные сохраняются между сессиями
- ✅ CSV файлы создаются в правильном формате
- ✅ Статус экспорта отображается корректно

### Известные ограничения
- ⚠️ Данные не сохраняются между запусками (упрощенная версия)
- ⚠️ Генерируются тестовые данные, а не реальные данные из Revit
- ⚠️ Нет интеграции с Revit API

## Устранение неполадок

### Приложение не запускается
1. Убедитесь, что установлен .NET Framework 4.8
2. Проверьте, что файл `RevitExporter.exe` существует в папке `bin\Debug\`

### Ошибки при экспорте
1. Убедитесь, что папка с моделями существует
2. Проверьте, что в папке есть файлы с расширением `.rvt`
3. Убедитесь, что у приложения есть права на запись в папку

### Проблемы с интерфейсом
1. Проверьте, что все элементы отображаются корректно
2. Убедитесь, что привязка данных работает (элементы появляются при выборе)

### Поля настроек не появляются
1. **Убедитесь, что вы выбрали вкладку** - кликните на неё в списке "Вкладки"
2. Если поля всё равно не появляются, попробуйте:
   - Создать новую вкладку и сразу выбрать её
   - Перезапустить приложение
   - Проверить, что в статусе нет ошибок

## Следующие шаги

После успешного тестирования упрощенной версии можно:

1. **Добавить реальную интеграцию с Revit API**:
   - Установить Autodesk Revit
   - Раскомментировать ссылки на Revit API в проекте
   - Реализовать реальную логику экспорта

2. **Добавить сохранение данных**:
   - Раскомментировать NuGet пакеты
   - Реализовать полноценную JSON сериализацию

3. **Улучшить интерфейс**:
   - Добавить валидацию ввода
   - Улучшить дизайн
   - Добавить дополнительные функции

---

**Примечание**: Это демонстрационная версия приложения. Для производственного использования требуется дополнительная разработка и интеграция с Revit API.
